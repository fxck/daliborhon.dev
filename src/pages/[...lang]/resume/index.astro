---
import ScrollIndicator from "@components/astro/resume/ScrollIndicator.astro";
import * as m from "$messages";
import { languageTag } from "$paraglide-runtime";
import { Image } from "astro:assets";
import { getEntry } from "astro:content";
import PageLayout from "@layouts/PageLayout.astro";
import profilePicture from "@assets/img/profile/me.png";
import type { CollectionEntry } from "astro:content";
import { getAbsoluteLocaleUrl } from "astro:i18n";
import { createResumePdfFilename } from "@utils";

export { getStaticPaths } from "@i18n/utils";

const locale = Astro.currentLocale!;

const resumeEntry = (await getEntry("resume", locale)) as CollectionEntry<"resume">;
const { Content } = await resumeEntry.render();

const layoutProps = {
    title: "Dalibor Hon - " + m.common__resume(),
    description: m.resume__resume_page_description(),
};
---

<PageLayout {...layoutProps}>
    <section class="hero-container" id="hero">
        <div class="hero">
            <div class="profile-picture-wrapper">
                <Image class="profile-picture" src={profilePicture} width={220} height={220} alt="Profile picture" />
            </div>
            <div class="hero-title-wrapper">
                <p>{resumeEntry.data.currentPosition.toUpperCase()}</p>
                <h1 class="hero-title text-accent">Dalibor Hon</h1>
                <a class="button is-anchor" href={getAbsoluteLocaleUrl(locale, `/resume/${createResumePdfFilename(locale, true)}`)} download>St√°hnout CV</a>
            </div>
        </div>
        <div class="section-footer noprint">
            <ScrollIndicator href="#content" />
        </div>
    </section>
    <article class="prose max-w-none dark:prose-invert" id="content">
        <Content />
    </article>
</PageLayout>

<style is:global>
    :root[data-theme="light"] {
        .cert-card-logo.dark {
            display: none;
        }
    }

    :root[data-theme="dark"] {
        .cert-card-logo.light {
            display: none;
        }
    }
</style>

<style>
    .hero-container {
        display: grid;
        justify-content: center;
        gap: 0.5rem;
        scroll-margin-top: 200px;
        align-items: center;
        min-height: calc(100svh - 4rem); /* Header padding */
    }

    .hero {
        display: flex;
        gap: 3rem;
    }

    .hero-title-wrapper > p {
        font-weight: 600;
        letter-spacing: 0.1rem;
        margin-top: 1rem;
        position: relative;
        font-size: 0.75rem;
        color: var(--body-color);
        opacity: 0.8;
    }

    .hero-title {
        font-size: 4rem;
        font-weight: 600;
    }

    .profile-picture-wrapper {
        position: relative;
        width: clamp(110px, 40vw, 190px);
        height: clamp(110px, 40vw, 190px);
        border-radius: 50%;
        margin-bottom: 2rem;
        margin-left: 0.2rem;
        box-shadow:
            0px 5px 30px 0px rgba(var(--accent), 0.8),
            0px 0px 0px 7px rgba(var(--accent), 0.5);
    }

    .profile-picture {
        display: block;
        object-fit: cover;
        border-radius: inherit;
        height: 100%;
    }

    .section-footer {
        display: flex;
        justify-content: center;
        align-items: center;
        align-self: flex-end;
        padding-bottom: 0.5rem;
    }

    .button {
        width: max-content;
        padding: 0.5rem;
        margin-top: 1rem;
    }
</style>
